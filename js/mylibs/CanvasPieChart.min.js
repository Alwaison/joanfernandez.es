function CanvasPieChart(h,a,j){var e={doc:document,imgDir:"images/",width:400,height:400,strokeLineWidth:2,strokeLineColor:"#FFFFFF",ticks:true,font:"Arial",fontSize:11,fontColor:"#FFFFFF",imageMap:true,onSectorMouseOver:function(){},onSectorClick:function(){},sectorTextRendrer:function(q,p){return Math.round(q.value/p*100)+"%"}};var o={};k(j);var g=a||[],b=null,n=null,f=o.doc.getElementById(h),l=c();function k(q){if(typeof j=="object"){var p;for(p in q){e[p]=q[p]}o=e}else{o=e}}function c(){var q=0,p;for(p=0;p<g.length;p++){q+=(typeof g[p].value=="number")?g[p].value:0}return q}function i(){b=o.doc.createElement("canvas");b.id=h+"-canvas";b.width=o.width;b.height=o.height;f.appendChild(b);n=b.getContext("2d")}function d(){var p,r,C,B,w,v,u,D,E,s,G,t,H,q,z,y,x,A,F;C=b.width;B=b.height;w=C/2;v=B/2;s=C/2-o.strokeLineWidth;t=0;n.clearRect(0,0,C,B);for(G=0;G<g.length;G++){u=g[G].label;D=g[G].value;E=g[G].color;H=D/l;q=Math.round(H*100);p=Math.PI*(-0.5+2*t);r=Math.PI*(-0.5+2*(t+H));n.lineWidth=o.strokeLineWidth;n.strokeStyle=o.strokeLineColor;n.fillStyle=E;n.beginPath();n.moveTo(w,v);n.arc(w,v,s,p,r,false);n.lineTo(w,v);n.fill();if(o.strokeLineWidth!=0){n.stroke()}t+=H}if(o.sectorTextRendrer){t=0;for(G=0;G<g.length;G++){D=g[G].value;E=g[G].color;H=D/l;p=Math.PI*(-0.5+2*t);r=Math.PI*(-0.5+2*(t+H));n.font=o.fontSize+"px "+o.font;A=o.sectorTextRendrer(g[G],l);F=n.measureText(A).width;z=(p+r)/2;y=w+Math.cos(z)*s/1.2-F/2;x=v+Math.sin(z)*s/1.2;n.fillStyle=o.fontColor;n.fillText(A,y,x);t+=H}}}function m(){var p,t,s,A,C,B,H,u,w,N,r,G,M,I,v,K,q,L,J,E,D,z,F;f.style.position="relative";r=o.doc.createElement("img");r.src=o.imgDir+"pix.png";r.border=0;r.width=b.width;r.height=b.height;r.style.position="absolute";r.style.left=0;r.style.top=0;r.useMap="#"+h+"-image-map";f.appendChild(r);G=o.doc.createElement("map");G.name=h+"-image-map";f.appendChild(G);u=b.width/2;A=12;C=1/A;w=0;for(L=0;L<g.length;L++){B=g[L].label;H=g[L].value;N=H/l;q=N*100;p=Math.PI*(-0.5+2*w);t=Math.PI*(-0.5+2*(w+N));s=(t-p)*C;E=u+Math.round(Math.cos(p)*u);D=u+Math.round(Math.sin(p)*u);I=[];v=1;for(J=0;J<((A*2)-2);J=J+2){K=p+s*v;I[J]=u+Math.round(Math.cos(K)*u);I[J+1]=u+Math.round(Math.sin(K)*u);v++}z=u+Math.round(Math.cos(t)*u);F=u+Math.round(Math.sin(t)*u);M=o.doc.createElement("area");M.shape="poly";M.coords=u+","+u+","+E+","+D+","+I.join(",")+","+z+","+F;M.data=g[L];M.data.key=L;if(o.onSectorClick){M.style.cursor="pointer";M.addEventListener("click",function(x){return o.onSectorClick(x,this.data)},false)}if(o.onSectorMouseOver){M.addEventListener("mouseover",function(x){return o.onSectorMouseOver(x,this.data)},false)}G.appendChild(M);w+=N}}i();d();if(o.imageMap){m()}};